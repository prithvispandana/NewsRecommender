Tammy Beaumont and Sarah Taylor both make hundreds as England set South Africa 374 to win.