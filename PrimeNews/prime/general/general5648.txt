The battle has left large parts of Mosul in ruins, killed thousands of civilians and displaced nearly one million people.