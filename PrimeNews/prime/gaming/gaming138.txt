Peter Capaldi's final season ends on a mixed note with one last battle with the Cybermen.