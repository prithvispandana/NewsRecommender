A fall in oil prices took a toll on energy stocks, capping gains on the S&P 500 and the Dow, while a rise in shares of chipmakers lifted the Nasdaq.