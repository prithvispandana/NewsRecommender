By the time Princeton University graduate student Xiyue Wang arrived in Iran to conduct research for his doctorate in history, he had already spent years living and working in politically turbulent countries.