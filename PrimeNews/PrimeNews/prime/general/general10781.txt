The government is seeking to prevent a repeat of rioting which marred the G20 summit in Hamburg.