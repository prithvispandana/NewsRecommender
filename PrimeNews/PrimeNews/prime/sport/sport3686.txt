England slump to 340-run defeat by South Africa on day four of the second Test at Trent Bridge.