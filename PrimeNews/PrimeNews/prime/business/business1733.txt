The most grueling stage so far of the Tour de France brought a mess of attacks, huge fractures in the peloton, and a surprise win for a French Tour rookie who nearly cramped his way out of contention.