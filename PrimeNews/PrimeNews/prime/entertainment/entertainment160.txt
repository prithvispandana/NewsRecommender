The London-based WPP advertising agency, the Ukrainian government, Russian oil giant Rosnef and Danish shipping firm AP Moller-Maersk have all been hit by a fresh ransomware virus.